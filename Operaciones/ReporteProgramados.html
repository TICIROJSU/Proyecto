<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="" />
    <meta name="author" content="mp" />
    <title>[SIPA WEB] v1.0</title>
    <link rel="icon" href="../img/logos-04.png" type="image/png">
    <!-- Estilos -->
    <link href="https://cdn.jsdelivr.net/npm/simple-datatables@7.1.2/dist/style.min.css" rel="stylesheet" />
    <link href="../css/styles.css" rel="stylesheet" />
    <!-- Fuentes e Iconos -->
    <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" crossorigin="anonymous"></script>
    <!-- Bootstrap y Dependencias -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.2/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <!-- Moment.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>

    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.25/css/dataTables.bootstrap4.min.css">
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.25/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.25/js/dataTables.bootstrap4.min.js"></script>
</head>
   <body class="sb-nav-fixed">
      <nav class="sb-topnav navbar navbar-expand navbar-dark bg-primary">
         <a class="navbar-brand ps-3" href="#">
         <img src="../img/logo.jpg" alt="SIPA-WEB" style="width: 150px; height: auto; border-radius: 10px;">
         </a>
         <button class="btn btn-link btn-sm order-1 order-lg-0 me-4 me-lg-0" id="sidebarToggle" href="#!"><i class="fas fa-bars"></i></button>
         <form class="d-none d-md-inline-block form-inline ms-auto me-0 me-md-3 my-2 my-md-0">
            <div class="input-group">
            </div>
         </form>
         <ul class="navbar-nav ms-auto ms-md-0 me-3 me-lg-4">
            <li class="nav-item dropdown">
               <a class="nav-link dropdown-toggle" id="navbarDropdown" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false"><i class="fas fa-user fa-fw"></i></a>
               <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDropdown">
                  <li><a class="dropdown-item" href="#!">Configuración</a></li>
                  <li>
                     <hr class="dropdown-divider" />
                  </li>
                  <li><a class="dropdown-item" href="#!">Cerrar Sesión</a></li>
               </ul>
            </li>
         </ul>
      </nav>
      <div id="layoutSidenav">
         <div id="layoutSidenav_nav">
            <nav class="sb-sidenav accordion" id="sidenavAccordion" style="background-color: #087cfc; color: white;">
               <div class="sb-sidenav-menu"  style="color: white;"  >
                  <div class="nav">
                     <div class="sb-sidenav-menu-heading">Core</div>
                     <a class="nav-link" href="index.html" style="color: white;">
                        <div class="sb-nav-link-icon"><i class="fas fa-hospital"></i></div>
                        Dashboard
                     </a>
                     <div class="sb-sidenav-menu-heading">SALA DE OPERACIONES</div>
                     <a class="nav-link collapsed"  style="color: white;"   href="#" data-toggle="collapse" data-target="#collapseCirugias" aria-expanded="false" aria-controls="collapseCirugias">
                        <div class="sb-nav-link-icon"><i class="fa-solid fa-hospital-user"></i></div>
                        &#160;Cirugías
                        <div class="sb-sidenav-collapse-arrow"><i class="fas fa-angle-down"></i></div>
                     </a>
                     <div class="collapse" id="collapseCirugias" aria-labelledby="headingOne" data-bs-parent="#sidenavAccordion">
                        <nav class="sb-sidenav-menu-nested nav"  style="color: white;"  >
                            <a class="nav-link" href="Principal.html"   style="color: white;" >Panel de Control</a>
                           <a class="nav-link" href="#"   style="color: white;" >Registrar</a>
                           <a class="nav-link" href="#"   style="color: white;" >Catálogo</a>
                           <a class="nav-link" href="#"   style="color: white;" >Ambientes</a>
                           <a class="nav-link" href="#"   style="color: white;" >Tipo de QX</a>
                           <a class="nav-link" href="../Operaciones/Paciente_Verificacion.html"   style="color: white;" >Cirugía Segura</a>
                           <a class="nav-link" href="ListadoPaquetes.html"   style="color: white;" >Paquetes</a>
                           <a class="nav-link" href="ReporteProgramacion.html"   style="color: white;" >Consultar Consejería</a>
                           <a class="nav-link" href="#"   style="color: white;" >Reporte General</a>
                           <a class="nav-link" href="ReporteEjecutadas.html"   style="color: white;" >Reporte Ejecutadas</a>
                           <a class="nav-link" href="ReporteProgramados.html"  style="color: white;" >Reporte Programación</a>
                        </nav>
                     </div>
                     <a class="nav-link collapsed"   style="color: white;"  href="#" data-toggle="collapse" data-target="#collapseProcedimientos" aria-expanded="false" aria-controls="collapseProcedimientos">
                        <div class="sb-nav-link-icon"><i class="fas fa-file-prescription"></i></div>
                        &#160;Procedimientos
                        <div class="sb-sidenav-collapse-arrow"><i class="fas fa-angle-down"></i></div>
                     </a>
                     <div class="collapse" id="collapseProcedimientos" aria-labelledby="headingOne" data-bs-parent="#sidenavAccordion">
                        <nav class="sb-sidenav-menu-nested nav">
                           <a class="nav-link" href="#"   style="color: white;" >Avastin</a>
                           <a class="nav-link" href="#"   style="color: white;" >Reporte General</a>
                        </nav>
                     </div>
                     <a class="nav-link collapsed" href="#"   style="color: white;"  data-toggle="collapse" data-target="#collapseProgramacion" aria-expanded="false" aria-controls="collapseProgramacion">
                        <div class="sb-nav-link-icon"><i class="fas fa-th-list"></i></div>
                        &#160;Programación
                        <div class="sb-sidenav-collapse-arrow"><i class="fas fa-angle-down"></i></div>
                     </a>
                     <div class="collapse" id="collapseProgramacion" aria-labelledby="headingOne" data-bs-parent="#sidenavAccordion">
                        <nav class="sb-sidenav-menu-nested nav">
                           <a class="nav-link" href="#"   style="color: white;" >Registrar </a>
                           <a class="nav-link" href="#"   style="color: white;" >Reporte Fecha </a>
                           <a class="nav-link" href="#"   style="color: white;" >Reporte General</a>
                        </nav>
                     </div>
                     <a class="nav-link collapsed"   style="color: white;"  href="#" data-toggle="collapse" data-target="#collapseLavanderia" aria-expanded="false" aria-controls="collapseLavanderia">
                        <div class="sb-nav-link-icon"><i class="fas fa-pump-medical"></i></i>
                        </div>
                        &#160;Lavandería
                        <div class="sb-sidenav-collapse-arrow"><i class="fas fa-angle-down"></i></div>
                     </a>
                     <div class="collapse" id="collapseLavanderia" aria-labelledby="headingOne" data-bs-parent="#sidenavAccordion">
                        <nav class="sb-sidenav-menu-nested nav">
                           <a class="nav-link" href="#"   style="color: white;" >Registrar (Kg.)</a>
                           <a class="nav-link" href="#"   style="color: white;" >Reporte Mensual</a>
                           <a class="nav-link" href="#"   style="color: white;" >Reporte General</a>
                        </nav>
                     </div>
                     <div class="sb-sidenav-menu-heading">PERSONAS</div>
                     <a class="nav-link collapsed"   style="color: white;"  href="#" data-toggle="collapse" data-target="#collapsePersonal" aria-expanded="false" aria-controls="collapsePersonal">
                        <div class="sb-nav-link-icon"><i class="fas fa-user-md"></i></div>
                        &#160;Personal
                        <div class="sb-sidenav-collapse-arrow"><i class="fas fa-angle-down"></i></div>
                     </a>
                     <div class="collapse" id="collapsePersonal" aria-labelledby="headingOne" data-bs-parent="#sidenavAccordion">
                        <nav class="sb-sidenav-menu-nested nav">
                           <a class="nav-link" href="#"   style="color: white;" >Cuerpo Médico</a>
                           <a class="nav-link" href="#"   style="color: white;" >Enfermería</a>
                           <a class="nav-link" href="#"   style="color: white;" >Técnicos</a>
                           <a class="nav-link" href="#"   style="color: white;" >Otros</a>
                        </nav>
                     </div>
                     <div class="sb-sidenav-menu-heading">ATENCIONES</div>
                     <a class="nav-link collapsed"   style="color: white;"  href="#" data-toggle="collapse" data-target="#collapsePaciente" aria-expanded="false" aria-controls="collapsePaciente">
                        <div class="sb-nav-link-icon"><i class="fas fa-hospital-user"></i></div>
                        &#160;Pacientes
                        <div class="sb-sidenav-collapse-arrow"><i class="fas fa-angle-down"></i></div>
                     </a>
                     <div class="collapse" id="collapsePaciente" aria-labelledby="headingOne" data-bs-parent="#sidenavAccordion">
                        <nav class="sb-sidenav-menu-nested nav">
                           <a class="nav-link" href="Pacientes/index.html"   style="color: white;" >Registrar</a>
                           <a class="nav-link" href="#"   style="color: white;" >Búsqueda</a>
                           <a class="nav-link" href="#"   style="color: white;" >Historial</a>
                        </nav>
                     </div>
                     <a class="nav-link collapsed"   style="color: white;"  href="#" data-toggle="collapse" data-target="#collapseServicioSocial" aria-expanded="false" aria-controls="collapseServicioSocial">
                        <div class="sb-nav-link-icon"><i class="fa-solid fa-hand-holding-medical"></i></div>
                        &#160;Servicio Social
                        <div class="sb-sidenav-collapse-arrow"><i class="fas fa-angle-down"></i></div>
                     </a>
                     <div class="collapse" id="collapseServicioSocial" aria-labelledby="headingOne" data-bs-parent="#sidenavAccordion">
                        <nav class="sb-sidenav-menu-nested nav">
                           <a class="nav-link" href="Pacientes/index.html"  style="color: white;" >Ficha Socio Económica</a>
                        </nav>
                     </div>
                     <div class="sb-sidenav-menu-heading">ÓPTICA</div>
                     <a class="nav-link collapsed"   style="color: white;"  href="#" data-toggle="collapse" data-target="#collapseOptica" aria-expanded="false" aria-controls="collapseOptica">
                        <div class="sb-nav-link-icon"><i class="fa-solid fa-glasses"></i></div>
                        &#160;Módulo de Óptica
                        <div class="sb-sidenav-collapse-arrow"><i class="fas fa-angle-down"></i></div>
                     </a>
                     <div class="collapse" id="collapseOptica" aria-labelledby="headingOne" data-bs-parent="#sidenavAccordion">
                         <nav class="sb-sidenav-menu-nested nav">
                           <a class="nav-link" href="../Optica/index.html"  style="color: white;" >Ingresos / Egresos</a>
                           <a class="nav-link" href="../Optica/OrdenesTrabajo.html"  style="color: white;" >Órdenes de Trabajo</a>
                           <a class="nav-link" href="../Optica/Productos.html"  style="color: white;" >Reporte Importes</a>
                           <a class="nav-link" href="../Optica/Kardex.html"  style="color: white;" >Kardex</a>
                           <a class="nav-link" href="../Optica/"  style="color: white;" >Proceso de Homologación</a>
                           <a class="nav-link" href="../Optica/"  style="color: white;" >Reporte General</a>
                        </nav>
                     </div>
                  </div>
               </div>
               <div class="sb-sidenav-footer">
                  <div class="small">USUARIO EN LINEA: [MPAZP]</div>
               </div>
            </nav>
         </div>
         <div id="layoutSidenav_content">
            <main>
               <div class="container-fluid px-4">
                  <BR>
                  <ol class="breadcrumb mb-4">
                     <li class="breadcrumb-item active">SALA DE OPERACIONES</li>
                  </ol>
               </div>
               <div class="container mt-3" style="font-size: 12px; max-width: 90%; margin-left: auto; margin-right: auto;">

                <div class="row">
                    <div class="col-sm-12  mb-3">
                        <div class="card">
                            <div class="card-body">
                                <h5 class="card-title">FILTRO DE FECHAS</h5>
                                <form>
                                    <div class="mb-3">
                                        <label for="fecha_inicio" class="form-label">Fecha de Inicio:</label>
                                        <input type="date" class="form-control" id="fecha_inicio" name="fecha_inicio" required>
                                    </div>
                                    <div class="mb-3">
                                        <label for="fecha_fin" class="form-label">Fecha Fin:</label>
                                        <input type="date" class="form-control" id="fecha_fin" name="fecha_fin" required>
                                    </div>
                                    <button type="submit" class="btn btn-primary" id="botonConsultar">Consultar</button>
                                </form>
                            </div>
                        </div>
                    </div>
               </div>

               <br>

                   <div class="row">
                      <div class="col-sm-6 mb-3">
                          <h6> <i class="fas fa-hospital"></i>  CONSULTA EXTERNA</h6>
                          <hr>
                          <div class="table-responsive">
                               <table class="table" id="tablaResultado_2">
                                  <thead class="thead-dark">
                                     <tr>
                                          <th>ID</th>
                                          <th>FECHA</th>
                                          <th>HORA</th>
                                          <th>HISTORIA</th>
                                          <th>DNI</th>
                                          <th>NOMBRES</th>
                                          <th>SERVICIO</th>
                                          <th>MÉDICO</th>
                                          <th>TP</th>
                                          <th>TURNO</th>
                                         
                                     </tr>
                                 </thead>
                                 <tbody id="cuerpoTabla_2">
                               
                                 </tbody>
                             </table>
                          </div>
                      </div>





                              <div class="col-sm-6 mb-3">
                          <h6> <i class="fas fa-user-md"></i>  SALA DE OPERACIONES</h6>
                          <hr>
                          <div class="table-responsive">
                               <table class="table" id="tablaResultado">
                                  <thead class="thead-dark">
                                     <tr>
                                          <th>ID</th>
                                          <th>DNI</th>
                                          <th>HHCC</th>
                                          <th>PATERNO</th>
                                          <th>MATERNO</th>
                                          <th>NOMBRES</th>
                                          <th>EDAD</th>
                                          <th>TE</th>
                                          <th>SEXO</th>
                                          <th>FECHA</th>
                                          <th>DIA</th>
                                          <th>MES</th>
                                          <th>AÑO</th>
                                          <th>DIAGNOSTICO</th>
                                          <th>PROGRAMACIÓN</th>
                                          <th>OJO</th>
                                          <th>TP</th>
                                          <th>SALA</th>
                                          <th>MÉDICO</th>
                                          <th>ASISTENTE</th>
                                          <th>ANESTE.</th>
                                          <th>TA</th>   
                                     </tr>
                                 </thead>
                                 <tbody id="cuerpoTabla">
                               
                                 </tbody>
                             </table>
                          </div>
                      </div>
                  </div>



    <script>
document.addEventListener('DOMContentLoaded', function () {
    const fechaInicioInput = document.getElementById('fecha_inicio');
    const fechaFinInput = document.getElementById('fecha_fin');
    const botonConsultar = document.getElementById('botonConsultar');
    const cuerpoTabla = document.getElementById('cuerpoTabla');
    const cuerpoTablaCitados = document.getElementById('cuerpoTabla_2');

    const dataTableOptions = {
        "paging": true,
        "searching": true,
    };

    let tablaResultados = $('#tablaResultado').DataTable(dataTableOptions);
    let tablaResultadosCitados = $('#tablaResultado_2').DataTable(dataTableOptions);

    botonConsultar.addEventListener('click', function (event) {
        event.preventDefault();

        const fechaInicio = fechaInicioInput.value;
        const fechaFin = fechaFinInput.value;

   
        tablaResultados.off('draw');
        tablaResultadosCitados.off('draw');


        tablaResultados.clear();
        tablaResultadosCitados.clear();

       
        fetch(`http://150.10.50.7:8000/Listado_Programacion_SOP?fecha_inicio=${fechaInicio}&fecha_fin=${fechaFin}`)
            .then(response => response.json())
            .then(data => mostrarResultados(data.Programacion, tablaResultados))
            .catch(error => console.error('Error al realizar la consulta:', error))
            .finally(() => {
          
                tablaResultados.on('draw', function () {

                });
            });

        fetch(`http://150.10.50.7:8000/Listado_Citados?FechaInicio=${fechaInicio}&FechaFin=${fechaFin}`)
            .then(response => response.json())
            .then(data => mostrarResultadosCitados(data.Citados, tablaResultadosCitados))
            .catch(error => console.error('Error al realizar la consulta de Citados:', error))
            .finally(() => {

                tablaResultadosCitados.on('draw', function () {
                });
            });
    });

    function mostrarResultados(resultados, tabla) {
        resultados.forEach(resultado => {
            const rowData = [
                resultado.ID,
                resultado.DNI,
                resultado.HHCC,
                resultado.Ape_Paterno,
                resultado.Ape_Materno,
                resultado.Nombres,
                resultado.Edad,
                resultado.Tipo_Edad,
                resultado.Sexo,
                resultado.Fecha_Programada,
                resultado.Dia,
                resultado.Mes,
                resultado.Ano,
                resultado.DX,
                resultado.Operacion_Programada,
                resultado.Ojo,
                resultado.Tipo_Paciente,
                resultado.Sala,
                resultado.Cirujano,
                resultado.Asistente,
                resultado.Anestesiologo,
                resultado.Tipo_Anestecia
            ];
            tabla.row.add(rowData);
        });

        tabla.draw();
    }

    function mostrarResultadosCitados(resultados, tabla) {
        resultados.forEach(resultado => {
            const rowData = [
                resultado.ID_CITA,
                resultado.Fecha,
                resultado.Hora,
                resultado.HCli,
                resultado.DNI,
                resultado.Nombres,
                resultado.Servicio,
                resultado.Medico,
                resultado.TipoPac,
                resultado.Turno
            ];
            tabla.row.add(rowData);
        });

        tabla.draw();
    }
});
</script>




               </div>
            </main>
            <br>
            <footer class="py-4 bg-light mt-auto">
               <div class="container-fluid px-4">
                  <div class="d-flex align-items-center justify-content-between small">
                     <div class="text-muted">Copyright &copy; [MP] 2024</div>
                     <div>
                     </div>
                  </div>
               </div>
            </footer>
         </div>
      </div>



      <script src="js/main.js"></script>
      <script src="../js/scripts.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js" crossorigin="anonymous"></script>
      <script src="../assets/demo/chart-area-demo.js"></script>
      <script src="../assets/demo/chart-bar-demo.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/simple-datatables@7.1.2/dist/umd/simple-datatables.min.js" crossorigin="anonymous"></script>
      <script src="../js/datatables-simple-demo.js"></script>
   </body>
</html>